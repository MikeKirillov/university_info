# info 02
#### Размещение ресурсов, использование ресурсов, чтение XLSX-файлов в Java
Данная часть работы продолжает реализацию проекта. Добавляется функционал, позволяющий получать данные, хранящиеся в файлах Excel. Обычно чтение таких файлов является большой проблемой, так как формат данных в Excel-файлах запутанный и неочевидный, то есть простым открытием файла и чтением символов тут не обойтись. Для этого в Java существует очень полезная и удобная библиотека — Apache POI. Именно её мы сейчас подключим и используем.

В рамках всего проекта это даст нам реализацию возможности читать Excel-файлы, которые нам подготавливают, например какие-нибудь бухгалтеры или юристы.

#### В ходе работы потребуется:

- Apache POI (одна из зависимостей, подключенных в предыдущем уроке);
- использование файлов из папки resources проекта;
- Java Collections.

#### В этом уроке необходимо выполнить следующее:

1. Скачать подготовленный файл XLSX. При желании можно продолжить заполнение файла произвольной подходящей информацией.
2. Разместить этот файл в папку ресурсов проекта.
3. Создать класс, отвечающий за чтение файла и создание из него коллекций студентов и университетов.
4. В файле необходимо реализовать запрет на создание экземпляра (приватный конструктор).
5. В файле необходимо реализовать два метода: один — для чтения студентов, второй — для чтения университетов. При чтении эти методы должны построчно читать табличный файл и собирать коллекции соответствующих элементов классов.
6. Реализовать занесение в класс University значения типа StudyProfile. Для этого необходимо текстовое поле из файла преобразовать в элемент enum.
7. Очистить метод main от предыдущего кода. Вместо этого реализовать получение коллекций с использованием написанного в п.4 класса, затем вывести в консоль все полученные элементы коллекций.
8. Дополнительное задание (теоретическое): разобраться, почему для Apache POI оказалось достаточно использовать только одну подключенную в Maven зависимость без указания других частей POI, которые, казалось бы, тоже надо упоминать.


#### Немного о работе с XLSX-файлами (аналогично можно работать с XLS и подобными)
Для работы с подобными файлами в Java удобно использовать библиотеку Apache POI. Она позволяет прочитать, изменить, создать новый файл, работать со стилями и т.д. Разумеется, это не единственный инструмент, но очень популярный, понятный и удобный в использовании, как и многие инструменты от Apache (мы также подключили Apache Commons, который используем в следующих уроках).

Порядок работы при чтении XLSX-файла:

1. Получаем содержимое файла как FileInputStream.
2. Создаём экземпляр класса XSSFWorkbook, передав его конструктору на вход стрим файла. Для файлов XLS (более старый формат) используется аналогичный класс HSSFWorkbook. Здесь Workbook — это сам документ Excel, его представление как объекта.
3. Затем надо получить страницу/лист. Для этого используем метод workbook.getSheet(имя_страницы). Метод возвращает экземпляр класса XSSFSheet (либо HSSFSheet, если мы работаем с XLS). Этот класс — представление конкретного листа из файла Excel. Можно получать листы как по их индексу (порядковый номер), так и по названию листа.
4. С листом мы работаем при помощи итератора. Создаём итератор, который перебирает строки нашего листа. Например, sheet.iterator().
5. Если в файле есть заголовок, нам надо его пропустить. Для этого достаточно просто вызвать iterator.next() перед тем, как мы будем обрабатывать информацию внутри цикла.
6. Затем в цикле while перебираем строки, предоставляемые итератором (экземпляры класса Row). Строки, очевидно, содержат в себе ячейки таблицы — элементы класса Cell.
7. Взятие ячейки из строки происходит с помощью метода row.getCell() по индексу ячейки.
8. Для получения значения из ячейки существует ряд методов, позволяющий прочитать значения различных типов. Например, getNumericCellValue(), getStringCellValue().

В конце данной части работы должны получиться следующие результаты:

- файл с данными добавлен в папку ресурсов проекта;
- реализовано чтение этого файла;
- реализован класс с методами для чтения информации из файла и сбора коллекций соответствующих экземпляров классов Student и University;
- реализован вывод в консоль информации о прочитанных строках файла.
